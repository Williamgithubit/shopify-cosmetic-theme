{% liquid
  assign heading = section.settings.heading
  assign subheading = section.settings.subheading
  assign button_text = section.settings.button_text
  assign show_phone = section.settings.show_phone
  assign show_subject = section.settings.show_subject
%}

<div class="contact-form-section section-spacing">
  <div class="page-width">
    <div class="contact-form-wrapper">
      <div class="contact-form-intro" data-scroll-reveal>
        {%- if heading != blank -%}
          <h2 class="contact-form__heading">{{ heading | escape }}</h2>
        {%- endif -%}
        {%- if subheading != blank -%}
          <p class="contact-form__subheading">{{ subheading | escape }}</p>
        {%- endif -%}

        {%- if section.settings.show_trust_badges -%}
          <div class="contact-form__trust-badges">
            <div class="trust-badge">
              <svg
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                aria-hidden="true">
                <polyline points="20 6 9 17 4 12" />
              </svg>
              <span>Response within 24 hours</span>
            </div>
            <div class="trust-badge">
              <svg
                width="20"
                height="20"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                aria-hidden="true">
                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
              </svg>
              <span>Your privacy is protected</span>
            </div>
          </div>
        {%- endif -%}
      </div>

      <div
        class="contact-form-container"
        data-scroll-reveal
        data-scroll-reveal-delay="200">
        {% form 'contact'
          , class: 'contact-form'
          , id: 'ContactForm' %}
          {%- if form.posted_successfully? -%}
            <div
              class="contact-form__success"
              role="status"
              aria-live="polite">
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                aria-hidden="true">
                <polyline points="20 6 9 17 4 12" />
              </svg>
              <div>
                <strong>Thank you for reaching out!</strong>
                <p>We've received your message and will get back to you within 24 hours.</p>
              </div>
            </div>
          {%- endif -%}

          {%- if form.errors -%}
            <div
              class="contact-form__error"
              role="alert"
              aria-live="assertive">
              <svg
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                aria-hidden="true">
                <circle
                  cx="12"
                  cy="12"
                  r="10" />
                <line
                  x1="12"
                  y1="8"
                  x2="12"
                  y2="12" />
                <line
                  x1="12"
                  y1="16"
                  x2="12.01"
                  y2="16" />
              </svg>
              <div>
                <strong>Please fix the following errors:</strong>
                <ul>
                  {%- for field in form.errors -%}
                    <li>{{ form.errors.messages[field] }}</li>
                  {%- endfor -%}
                </ul>
              </div>
            </div>
          {%- endif -%}

          <div class="contact-form__fields">
            <div class="form-field">
              <label for="ContactForm-name" class="form-label">
                Name
                <span class="required" aria-label="required">*</span>
              </label>
              <input
                type="text"
                id="ContactForm-name"
                name="contact[name]"
                class="form-input"
                value="{% if form.name %}{{ form.name }}{% endif %}"
                required
                aria-required="true"
                autocomplete="name"
                {% if form.errors contains 'name' %}
                aria-invalid="true"
                aria-describedby="ContactForm-name-error"
                {% endif %}>
              {%- if form.errors contains 'name' -%}
                <span id="ContactForm-name-error" class="form-error">
                  {{ form.errors.messages.name }}
                </span>
              {%- endif -%}
            </div>

            <div class="form-field">
              <label for="ContactForm-email" class="form-label">
                Email
                <span class="required" aria-label="required">*</span>
              </label>
              <input
                type="email"
                id="ContactForm-email"
                name="contact[email]"
                class="form-input"
                value="{% if form.email %}{{ form.email }}{% endif %}"
                required
                aria-required="true"
                autocomplete="email"
                {% if form.errors contains 'email' %}
                aria-invalid="true"
                aria-describedby="ContactForm-email-error"
                {% endif %}>
              {%- if form.errors contains 'email' -%}
                <span id="ContactForm-email-error" class="form-error">
                  {{ form.errors.messages.email }}
                </span>
              {%- endif -%}
            </div>

            {%- if show_phone -%}
              <div class="form-field">
                <label for="ContactForm-phone" class="form-label">
                  Phone
                  <span class="optional">(Optional)</span>
                </label>
                <input
                  type="tel"
                  id="ContactForm-phone"
                  name="contact[phone]"
                  class="form-input"
                  value="{% if form.phone %}{{ form.phone }}{% endif %}"
                  autocomplete="tel">
              </div>
            {%- endif -%}

            {%- if show_subject -%}
              <div class="form-field form-field--full">
                <label for="ContactForm-subject" class="form-label">
                  Subject
                </label>
                <select
                  id="ContactForm-subject"
                  name="contact[subject]"
                  class="form-select">
                  <option value="">Select a topic...</option>
                  <option value="Product Question">Product Question</option>
                  <option value="Order Help">Order Help</option>
                  <option value="Shade Advice">Shade Advice</option>
                  <option value="Returns & Exchanges">Returns & Exchanges</option>
                  <option value="Wholesale Inquiry">Wholesale Inquiry</option>
                  <option value="Other">Other</option>
                </select>
              </div>
            {%- endif -%}

            <div class="form-field form-field--full">
              <label for="ContactForm-message" class="form-label">
                Message
                <span class="required" aria-label="required">*</span>
              </label>
              <textarea
                id="ContactForm-message"
                name="contact[body]"
                class="form-textarea"
                rows="6"
                required
                aria-required="true"
                {% if form.errors contains 'body' %}
                aria-invalid="true"
                aria-describedby="ContactForm-message-error"
                {% endif %}>
                {% if form.body %}
                  {{ form.body }}{% endif %}
              </textarea>
              {%- if form.errors contains 'body' -%}
                <span id="ContactForm-message-error" class="form-error">
                  {{ form.errors.messages.body }}
                </span>
              {%- endif -%}
            </div>
          </div>

          <button
            type="submit"
            class="contact-form__submit"
            id="ContactFormSubmit">
            <span class="submit-text">{{ button_text | escape }}</span>
            <span class="submit-loading" style="display: none;">
              <span class="loading-spinner"></span>
              Sending...
            </span>
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              aria-hidden="true">
              <line
                x1="22"
                y1="2"
                x2="11"
                y2="13" />
              <polygon points="22 2 15 22 11 13 2 9 22 2" />
            </svg>
          </button>
        {% endform %}
      </div>
    </div>
  </div>
</div>

<style>
  .contact-form-section {
    background: white;
  }

  .contact-form-wrapper {
    max-width: 800px;
    margin: 0 auto;
  }

  .contact-form-intro {
    text-align: center;
    margin-bottom: var(--spacing-3xl, 64px);
  }

  .contact-form__heading {
    font-size: clamp(1.25rem, 2.5vw, 1.5rem);
    font-weight: 700;
    margin-bottom: var(--spacing-sm, 8px);
    color: var(--color-text, #2c2c2c);
  }

  .contact-form__subheading {
    font-size: 0.8125rem;
    color: #666;
    line-height: 1.5;
    margin-bottom: var(--spacing-lg, 24px);
  }

  .contact-form__trust-badges {
    display: flex;
    justify-content: center;
    gap: var(--spacing-xl, 32px);
    flex-wrap: wrap;
  }

  .trust-badge {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs, 4px);
    padding: 6px 14px;
    background: rgba(212, 165, 116, 0.1);
    border-radius: var(--radius-full, 9999px);
    color: var(--color-primary, #d4a574);
    font-size: 0.6875rem;
    font-weight: 600;
  }

  .contact-form-container {
    background: #fafafa;
    padding: var(--spacing-3xl, 64px) var(--spacing-2xl, 48px);
    border-radius: var(--radius-xl, 16px);
    box-shadow: var(--shadow-lg, 0 10px 15px -3px rgba(0, 0, 0, 0.1));
  }

  .contact-form__success,
  .contact-form__error {
    display: flex;
    gap: var(--spacing-md, 16px);
    padding: var(--spacing-lg, 24px);
    border-radius: var(--radius-md, 8px);
    margin-bottom: var(--spacing-xl, 32px);
  }

  .contact-form__success {
    background: rgba(76, 175, 80, 0.1);
    border: 2px solid #4caf50;
    color: #2e7d32;
  }

  .contact-form__success svg {
    color: #4caf50;
    flex-shrink: 0;
  }

  .contact-form__error {
    background: rgba(211, 47, 47, 0.1);
    border: 2px solid #d32f2f;
    color: #c62828;
  }

  .contact-form__error svg {
    color: #d32f2f;
    flex-shrink: 0;
  }

  .contact-form__error ul {
    margin: var(--spacing-sm, 8px) 0 0;
    padding-left: var(--spacing-lg, 24px);
  }

  .contact-form__fields {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: var(--spacing-lg, 24px);
    margin-bottom: var(--spacing-xl, 32px);
  }

  .form-field--full {
    grid-column: 1 / -1;
  }

  .form-label {
    display: block;
    font-size: 0.75rem;
    font-weight: 600;
    margin-bottom: var(--spacing-xs, 4px);
    color: var(--color-text, #2c2c2c);
  }

  .required {
    color: #d32f2f;
  }

  .optional {
    font-weight: 400;
    color: #999;
    font-size: 0.625rem;
  }

  .form-input,
  .form-select,
  .form-textarea {
    width: 100%;
    padding: 10px 14px;
    border: 2px solid #e5e5e5;
    border-radius: var(--radius-md, 8px);
    font-size: 0.75rem;
    font-family: inherit;
    background: white;
    transition: all var(--transition-fast, 0.15s);
  }

  .form-input:hover,
  .form-select:hover,
  .form-textarea:hover {
    border-color: #d4d4d4;
  }

  .form-input:focus,
  .form-select:focus,
  .form-textarea:focus {
    outline: none;
    border-color: var(--color-primary, #d4a574);
    box-shadow: 0 0 0 3px rgba(212, 165, 116, 0.1);
  }

  .form-input[aria-invalid="true"],
  .form-textarea[aria-invalid="true"] {
    border-color: #d32f2f;
  }

  .form-input[aria-invalid="true"]:focus,
  .form-textarea[aria-invalid="true"]:focus {
    box-shadow: 0 0 0 3px rgba(211, 47, 47, 0.1);
  }

  .form-textarea {
    resize: vertical;
    min-height: 150px;
  }

  .form-error {
    display: block;
    margin-top: var(--spacing-xs, 4px);
    font-size: 0.625rem;
    color: #d32f2f;
  }

  .contact-form__submit {
    width: 100%;
    padding: 12px 24px;
    background: linear-gradient(135deg, var(--color-primary, #d4a574) 0%, var(--color-secondary, #c89563) 100%);
    color: white;
    border: none;
    border-radius: var(--radius-md, 8px);
    font-size: 0.75rem;
    font-weight: 600;
    cursor: pointer;
    transition: all var(--transition-base, 0.25s);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-xs, 4px);
  }

  .contact-form__submit:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: var(--shadow-xl, 0 20px 25px -5px rgba(0, 0, 0, 0.1));
  }

  .contact-form__submit:focus {
    outline: none;
    box-shadow: 0 0 0 4px rgba(212, 165, 116, 0.3);
  }

  .contact-form__submit:disabled {
    opacity: 0.6;
    cursor: not-allowed;
  }

  .submit-loading {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm, 8px);
  }

  @media screen and (max-width: 749px) {
    .contact-form-container {
      padding: var(--spacing-2xl, 48px) var(--spacing-lg, 24px);
    }

    .contact-form__fields {
      grid-template-columns: 1fr;
    }

    .contact-form__trust-badges {
      flex-direction: column;
      align-items: center;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('ContactForm');
    const submitBtn = document.getElementById('ContactFormSubmit');
    
    if (form && submitBtn) {
      form.addEventListener('submit', function() {
        submitBtn.disabled = true;
        submitBtn.querySelector('.submit-text').style.display = 'none';
        submitBtn.querySelector('.submit-loading').style.display = 'flex';
        submitBtn.querySelector('svg').style.display = 'none';
      });
    }
  });
</script>

{% schema %}
  {
    "name": "Contact Form",
    "tag": "section",
    "class": "section-contact-form",
    "settings": [
      {
        "type": "text",
        "id": "heading",
        "label": "Heading",
        "default": "Send Us a Message"
      },
      {
        "type": "textarea",
        "id": "subheading",
        "label": "Subheading",
        "default": "Fill out the form below and we'll get back to you as soon as possible"
      },
      {
        "type": "text",
        "id": "button_text",
        "label": "Button text",
        "default": "Send Message"
      },
      {
        "type": "checkbox",
        "id": "show_phone",
        "label": "Show phone field",
        "default": true
      }, {
        "type": "checkbox",
        "id": "show_subject",
        "label": "Show subject dropdown",
        "default": true
      }, {
        "type": "checkbox",
        "id": "show_trust_badges",
        "label": "Show trust badges",
        "default": true,
        "info": "Displays response time and privacy badges"
      }
    ],
    "presets": [
      {
        "name": "Contact Form"
      }
    ]
  }
{% endschema %}