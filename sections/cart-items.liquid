{% liquid
  assign show_vendor = section.settings.show_vendor
%}

<div class="cart-items section-spacing">
  <div class="page-width">
    <h1 class="cart-items__title h2">{{ 'sections.cart.title' | t }}</h1>

    <form
      action="{{ routes.cart_url }}"
      method="post"
      class="cart-items__form"
      id="cart">
      {%- if cart.item_count > 0 -%}
        <div class="cart-items__table">
          <div class="cart-items__header">
            <div class="cart-items__header-image"></div>
            <div class="cart-items__header-item">{{ 'sections.cart.headings.product' | t }}</div>
            <div class="cart-items__header-price">{{ 'sections.cart.headings.price' | t }}</div>
            <div class="cart-items__header-quantity">{{ 'sections.cart.headings.quantity' | t }}</div>
            <div class="cart-items__header-total">{{ 'sections.cart.headings.total' | t }}</div>
            <div class="cart-items__header-remove"></div>
          </div>

          {%- for item in cart.items -%}
            <div
              class="cart-item"
              data-cart-item
              data-line="{{ forloop.index }}">
              <div class="cart-item__media">
                {%- if item.image -%}
                  <img
                    src="{{ item.image | image_url: width: 150 }}"
                    alt="{{ item.image.alt | escape }}"
                    width="150"
                    height="150"
                    loading="lazy">
                {%- endif -%}
              </div>

              <div class="cart-item__details">
                <a href="{{ item.url }}" class="cart-item__title">{{ item.product.title | escape }}</a>
                {%- if item.product.has_only_default_variant == false or item.properties.size > 0 -%}
                  <dl class="cart-item__options">
                    {%- unless item.product.has_only_default_variant -%}
                      {%- for option in item.options_with_values -%}
                        <div class="cart-item__option">
                          <dt>{{ option.name }}:</dt>
                          <dd>{{ option.value }}</dd>
                        </div>
                      {%- endfor -%}
                    {%- endunless -%}
                  </dl>
                {%- endif -%}
                {%- if show_vendor -%}
                  <p class="cart-item__vendor">{{ item.vendor }}</p>
                {%- endif -%}
              </div>

              <div class="cart-item__price">
                {% render 'price'
                  , product: item
                  , use_variant: true %}
              </div>

              <div class="cart-item__quantity">
                <div class="quantity-selector">
                  <button
                    class="quantity-selector__button"
                    type="button"
                    name="minus"
                    data-quantity-minus
                    aria-label="{{ 'products.product.quantity_decrease' | t }}">
                    {% render 'icon-minus' %}
                  </button>
                  <input
                    class="quantity-selector__input"
                    type="number"
                    name="updates[]"
                    value="{{ item.quantity }}"
                    min="0"
                    data-quantity-input
                    data-line="{{ forloop.index }}"
                    aria-label="{{ 'products.product.quantity_label' | t }}">
                  <button
                    class="quantity-selector__button"
                    type="button"
                    name="plus"
                    data-quantity-plus
                    aria-label="{{ 'products.product.quantity_increase' | t }}">
                    {% render 'icon-plus' %}
                  </button>
                </div>
              </div>

              <div class="cart-item__total">
                <span>{{ item.final_line_price | money }}</span>
              </div>

              <div class="cart-item__remove-wrapper">
                <button
                  type="button"
                  class="cart-item__remove"
                  data-cart-remove
                  data-line="{{ forloop.index }}"
                  aria-label="{{ 'sections.cart.remove_title' | t: title: item.title }}">
                  <svg
                    width="20"
                    height="20"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M3 6h18" />
                    <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6" />
                    <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2" />
                    <line
                      x1="10"
                      y1="11"
                      x2="10"
                      y2="17" />
                    <line
                      x1="14"
                      y1="11"
                      x2="14"
                      y2="17" />
                  </svg>
                </button>
              </div>
            </div>
          {%- endfor -%}
        </div>
      {%- else -%}
        <div class="cart-items__empty">
          <p>{{ 'sections.cart.empty' | t }}</p>
          <a href="{{ routes.all_products_collection_url }}" class="button button--primary">
            {{ 'general.continue_shopping' | t }}
          </a>
        </div>
      {%- endif -%}
    </form>
  </div>
</div>

{% schema %}
  {
    "name": "Cart Items",
    "tag": "section",
    "class": "section-cart-items",
    "settings": [
      {
        "type": "checkbox",
        "id": "show_vendor",
        "label": "Show vendor",
        "default": false
      }
    ]
  }
{% endschema %}