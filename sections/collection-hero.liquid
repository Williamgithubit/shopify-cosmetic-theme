{% liquid
  assign show_collection_description = section.settings.show_collection_description
  assign show_collection_image = section.settings.show_collection_image
  assign show_promo_bar = section.settings.show_promo_bar
  assign promo_text = section.settings.promo_text
  assign hero_height = section.settings.hero_height
  assign overlay_opacity = section.settings.overlay_opacity
  assign text_alignment = section.settings.text_alignment
  assign background_color = section.settings.background_color
  assign text_color = section.settings.text_color
  assign accent_color = section.settings.accent_color
  assign promo_bar_background = section.settings.promo_bar_background
  assign promo_bar_text = section.settings.promo_bar_text

  assign custom_background_image = section.settings.custom_background_image
  assign background_position = section.settings.background_position
  assign background_size = section.settings.background_size
  assign background_repeat = section.settings.background_repeat
  assign overlay_color = section.settings.overlay_color
  assign custom_overlay_opacity = section.settings.custom_overlay_opacity

  assign title_font_size = section.settings.title_font_size
  assign title_font_weight = section.settings.title_font_weight
  assign title_text_transform = section.settings.title_text_transform
  assign breadcrumb_font_size = section.settings.breadcrumb_font_size
  assign description_font_size = section.settings.description_font_size
%}

<style>
  .section-collection-hero .collection-hero {
    background-color: {{ background_color }};
    color: {{ text_color }};
    {%- if custom_background_image != blank -%}
      background-image: url('{{ custom_background_image | image_url: width: 1920 }}');
      background-position: {{ background_position }};
      background-size: {{ background_size }};
      background-repeat: {{ background_repeat }};
    {%- endif -%}
  }

  .section-collection-hero .collection-hero__overlay {
    background-color: {{ overlay_color }};
    opacity: {{ custom_overlay_opacity | divided_by: 100.0 }};
  }

  .section-collection-hero .collection-hero__promo-bar {
    background: {{ promo_bar_background }};
    color: {{ promo_bar_text }};
  }

  .section-collection-hero .collection-hero__title {
    color: {{ text_color }};
    font-size: {{ title_font_size }}px;
    font-weight: {{ title_font_weight }};
    text-transform: {{ title_text_transform }};
  }

  .section-collection-hero .collection-hero__description {
    color: {{ text_color }};
    font-size: {{ description_font_size }}px;
  }

  .section-collection-hero .collection-hero__breadcrumbs {
    font-size: {{ breadcrumb_font_size }}px;
  }

  .section-collection-hero .collection-hero__breadcrumb-link {
    color: {{ text_color }};
  }

  .section-collection-hero .collection-hero__count {
    color: {{ accent_color }};
  }

  .section-collection-hero .collection-hero__breadcrumb-link:hover {
    color: {{ accent_color }};
  }

  @media screen and (max-width: 749px) {
    .section-collection-hero .collection-hero__title {
      font-size: calc({{ title_font_size }}px * 0.75);
    }
    .section-collection-hero .collection-hero__description {
      font-size: calc({{ description_font_size }}px * 0.9);
    }
    .section-collection-hero .collection-hero__breadcrumbs {
      font-size: calc({{ breadcrumb_font_size }}px * 0.9);
    }
  }
</style>

<div class="collection-hero collection-hero--{{ hero_height }} collection-hero--{{ text_alignment }}" role="banner">
  {%- if show_promo_bar and promo_text != blank -%}
    <div class="collection-hero__promo-bar">
      <div class="page-width">
        <p class="collection-hero__promo-text">
          {% render 'icon-truck' %}
          <span>{{ promo_text }}</span>
        </p>
      </div>
    </div>
  {%- endif -%}

  <div class="collection-hero__main">
    {%- if custom_background_image == blank -%}
      {%- if show_collection_image and collection.image -%}
        <div class="collection-hero__media">
          <img
            srcset="
              {%- if collection.image.width >= 375 -%}{{ collection.image | image_url: width: 375 }} 375w,{%- endif -%}
              {%- if collection.image.width >= 750 -%}{{ collection.image | image_url: width: 750 }} 750w,{%- endif -%}
              {%- if collection.image.width >= 1100 -%}{{ collection.image | image_url: width: 1100 }} 1100w,{%- endif -%}
              {%- if collection.image.width >= 1500 -%}{{ collection.image | image_url: width: 1500 }} 1500w,{%- endif -%}
              {%- if collection.image.width >= 1920 -%}{{ collection.image | image_url: width: 1920 }} 1920w,{%- endif -%}
              {{ collection.image | image_url }} {{ collection.image.width }}w
            "
            sizes="100vw"
            src="{{ collection.image | image_url: width: 1920 }}"
            loading="eager"
            fetchpriority="high"
            alt="{{ collection.image.alt | default: collection.title | escape }}"
            width="{{ collection.image.width }}"
            height="{{ collection.image.height }}"
            class="collection-hero__image">
        </div>
      {%- else -%}
        <div class="collection-hero__gradient"></div>
      {%- endif -%}
    {%- endif -%}

    {%- if custom_background_image != blank -%}
      <div class="collection-hero__overlay"></div>
    {%- elsif show_collection_image and collection.image -%}
      <div class="collection-hero__overlay"></div>
    {%- endif -%}

    <div class="collection-hero__content page-width">
      <div class="collection-hero__text-wrapper">
        {%- if section.settings.show_breadcrumbs -%}
          <nav
            class="collection-hero__breadcrumbs"
            role="navigation"
            aria-label="Breadcrumb">
            <a href="/" class="collection-hero__breadcrumb-link">{{ 'general.breadcrumbs.home' | t }}</a>
            <span>/</span>
            <span class="collection-hero__breadcrumb-current">{{ collection.title | escape }}</span>
          </nav>
        {%- endif -%}

        <h1 class="collection-hero__title">
          {{ collection.title | escape }}
        </h1>

        {%- if show_collection_description and collection.description != blank -%}
          <div class="collection-hero__description rte">
            {{ collection.description }}
          </div>
        {%- endif -%}

        {%- if section.settings.show_product_count -%}
          <p class="collection-hero__count">
            {{ 'collections.general.items_with_count' | t: count: collection.products_count }}
          </p>
        {%- endif -%}
      </div>
    </div>
  </div>
</div>

{% schema %}
  {
    "name": "Collection Hero",
    "tag": "section",
    "class": "section-collection-hero",
    "settings": [
      {
        "type": "header",
        "content": "Layout"
      },
      {
        "type": "select",
        "id": "hero_height",
        "label": "Hero height",
        "options": [
          {
            "value": "small",
            "label": "Small"
          }, {
            "value": "medium",
            "label": "Medium"
          }, {
            "value": "large",
            "label": "Large"
          }
        ],
        "default": "medium"
      },
      {
        "type": "select",
        "id": "text_alignment",
        "label": "Text alignment",
        "options": [
          {
            "value": "left",
            "label": "Left"
          }, {
            "value": "center",
            "label": "Center"
          }
        ],
        "default": "center"
      },
      {
        "type": "header",
        "content": "Content"
      }, {
        "type": "checkbox",
        "id": "show_collection_image",
        "label": "Show collection image",
        "default": true
      }, {
        "type": "range",
        "id": "overlay_opacity",
        "min": 0,
        "max": 80,
        "step": 5,
        "unit": "%",
        "label": "Image overlay opacity",
        "default": 30
      }, {
        "type": "checkbox",
        "id": "show_breadcrumbs",
        "label": "Show breadcrumbs",
        "default": true
      }, {
        "type": "checkbox",
        "id": "show_collection_description",
        "label": "Show collection description",
        "default": true
      }, {
        "type": "checkbox",
        "id": "show_product_count",
        "label": "Show product count",
        "default": true
      }, {
        "type": "header",
        "content": "Promotional Bar"
      }, {
        "type": "checkbox",
        "id": "show_promo_bar",
        "label": "Show promotional bar",
        "default": true
      }, {
        "type": "text",
        "id": "promo_text",
        "label": "Promotional text",
        "default": "Free shipping on orders over $50"
      }, {
        "type": "header",
        "content": "Colors"
      }, {
        "type": "color",
        "id": "background_color",
        "label": "Background color",
        "default": "#F5EDE6"
      }, {
        "type": "color",
        "id": "text_color",
        "label": "Text color",
        "default": "#2C2C2C"
      }, {
        "type": "color",
        "id": "accent_color",
        "label": "Accent color (product count)",
        "default": "#D4A373"
      }, {
        "type": "color",
        "id": "promo_bar_background",
        "label": "Promo bar background",
        "default": "#D4A373"
      }, {
        "type": "color",
        "id": "promo_bar_text",
        "label": "Promo bar text color",
        "default": "#FFFFFF"
      }, {
        "type": "header",
        "content": "Typography"
      }, {
        "type": "range",
        "id": "title_font_size",
        "min": 24,
        "max": 80,
        "step": 2,
        "unit": "px",
        "label": "Title font size",
        "default": 48
      }, {
        "type": "select",
        "id": "title_font_weight",
        "label": "Title font weight",
        "options": [
          {
            "value": "300",
            "label": "Light"
          },
          {
            "value": "400",
            "label": "Normal"
          },
          {
            "value": "500",
            "label": "Medium"
          },
          {
            "value": "600",
            "label": "Semi Bold"
          }, {
            "value": "700",
            "label": "Bold"
          }
        ],
        "default": "400"
      }, {
        "type": "select",
        "id": "title_text_transform",
        "label": "Title text style",
        "options": [
          {
            "value": "none",
            "label": "Normal"
          }, {
            "value": "uppercase",
            "label": "Uppercase"
          }, {
            "value": "lowercase",
            "label": "Lowercase"
          }, {
            "value": "capitalize",
            "label": "Capitalize"
          }
        ],
        "default": "none"
      }, {
        "type": "range",
        "id": "breadcrumb_font_size",
        "min": 10,
        "max": 20,
        "step": 1,
        "unit": "px",
        "label": "Breadcrumb font size",
        "default": 14
      }, {
        "type": "range",
        "id": "description_font_size",
        "min": 12,
        "max": 24,
        "step": 1,
        "unit": "px",
        "label": "Description font size",
        "default": 16
      }, {
        "type": "header",
        "content": "Background Image"
      }, {
        "type": "image_picker",
        "id": "custom_background_image",
        "label": "Custom background image",
        "info": "Overrides collection image. Recommended: 1920x600px or larger"
      }, {
        "type": "select",
        "id": "background_position",
        "label": "Background position",
        "options": [
          {
            "value": "top left",
            "label": "Top Left"
          },
          {
            "value": "top center",
            "label": "Top Center"
          },
          {
            "value": "top right",
            "label": "Top Right"
          },
          {
            "value": "center left",
            "label": "Center Left"
          }, {
            "value": "center center",
            "label": "Center"
          }, {
            "value": "center right",
            "label": "Center Right"
          }, {
            "value": "bottom left",
            "label": "Bottom Left"
          }, {
            "value": "bottom center",
            "label": "Bottom Center"
          }, {
            "value": "bottom right",
            "label": "Bottom Right"
          }
        ],
        "default": "center center"
      }, {
        "type": "select",
        "id": "background_size",
        "label": "Background size",
        "options": [
          {
            "value": "cover",
            "label": "Cover (fill area)"
          }, {
            "value": "contain",
            "label": "Contain (fit in area)"
          }, {
            "value": "auto",
            "label": "Auto (original size)"
          }
        ],
        "default": "cover",
        "info": "Cover fills the entire area, Contain fits the whole image"
      }, {
        "type": "select",
        "id": "background_repeat",
        "label": "Background repeat",
        "options": [
          {
            "value": "no-repeat",
            "label": "No Repeat"
          }, {
            "value": "repeat",
            "label": "Repeat"
          }, {
            "value": "repeat-x",
            "label": "Repeat Horizontally"
          }, {
            "value": "repeat-y",
            "label": "Repeat Vertically"
          }
        ],
        "default": "no-repeat"
      }, {
        "type": "color",
        "id": "overlay_color",
        "label": "Overlay color",
        "default": "#000000",
        "info": "Color overlay to improve text readability"
      }, {
        "type": "range",
        "id": "custom_overlay_opacity",
        "min": 0,
        "max": 80,
        "step": 5,
        "unit": "%",
        "label": "Overlay opacity",
        "default": 30,
        "info": "Adjust overlay darkness for better text contrast"
      }
    ]
  }
{% endschema %}