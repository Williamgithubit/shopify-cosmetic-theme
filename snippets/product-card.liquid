{% liquid
  if product == blank
    assign placeholder = true
  else
    assign placeholder = false
  endif

  assign show_vendor = settings.product_show_vendor | default: false
  assign show_quick_add = section.settings.enable_quick_add | default: true
%}

<div class="product-card" data-product-id="{{ product.id }}">
  <a href="{{ product.url | default: '#' }}" class="product-card__link">
    <div class="product-card__media">
      {%- if placeholder -%}
        <div class="product-card__image placeholder-svg">
          {{ 'product-1' | placeholder_svg_tag: 'placeholder-svg__image' }}
        </div>
      {%- elsif product.featured_media -%}
        <img
          srcset="
            {%- if product.featured_media.width >= 165 -%}{{ product.featured_media | image_url: width: 165 }} 165w,{%- endif -%}
            {%- if product.featured_media.width >= 360 -%}{{ product.featured_media | image_url: width: 360 }} 360w,{%- endif -%}
            {%- if product.featured_media.width >= 533 -%}{{ product.featured_media | image_url: width: 533 }} 533w,{%- endif -%}
            {%- if product.featured_media.width >= 720 -%}{{ product.featured_media | image_url: width: 720 }} 720w,{%- endif -%}
            {%- if product.featured_media.width >= 940 -%}{{ product.featured_media | image_url: width: 940 }} 940w,{%- endif -%}
            {%- if product.featured_media.width >= 1066 -%}{{ product.featured_media | image_url: width: 1066 }} 1066w,{%- endif -%}
            {{ product.featured_media | image_url }} {{ product.featured_media.width }}w
          "
          src="{{ product.featured_media | image_url: width: 533 }}"
          sizes="(min-width: 990px) calc((100vw - 130px) / 4), (min-width: 750px) calc((100vw - 120px) / 3), calc((100vw - 35px) / 2)"
          alt="{{ product.featured_media.alt | escape }}"
          class="product-card__image"
          loading="lazy"
          width="{{ product.featured_media.width }}"
          height="{{ product.featured_media.height }}">

        {%- if product.media[1] != nil -%}
          <img
            srcset="
              {%- if product.media[1].width >= 165 -%}{{ product.media[1] | image_url: width: 165 }} 165w,{%- endif -%}
              {%- if product.media[1].width >= 360 -%}{{ product.media[1] | image_url: width: 360 }} 360w,{%- endif -%}
              {%- if product.media[1].width >= 533 -%}{{ product.media[1] | image_url: width: 533 }} 533w,{%- endif -%}
              {%- if product.media[1].width >= 720 -%}{{ product.media[1] | image_url: width: 720 }} 720w,{%- endif -%}
              {%- if product.media[1].width >= 940 -%}{{ product.media[1] | image_url: width: 940 }} 940w,{%- endif -%}
              {%- if product.media[1].width >= 1066 -%}{{ product.media[1] | image_url: width: 1066 }} 1066w,{%- endif -%}
              {{ product.media[1] | image_url }} {{ product.media[1].width }}w
            "
            src="{{ product.media[1] | image_url: width: 533 }}"
            sizes="(min-width: 990px) calc((100vw - 130px) / 4), (min-width: 750px) calc((100vw - 120px) / 3), calc((100vw - 35px) / 2)"
            alt="{{ product.media[1].alt | escape }}"
            class="product-card__image product-card__image--hover"
            loading="lazy"
            width="{{ product.media[1].width }}"
            height="{{ product.media[1].height }}">
        {%- endif -%}
      {%- endif -%}

      {%- unless placeholder -%}
        {%- if product.available == false -%}
          <div class="product-card__badge product-card__badge--sold-out">
            {{ 'products.product.sold_out' | t }}
          </div>
        {%- elsif product.compare_at_price > product.price -%}
          <div class="product-card__badge product-card__badge--sale">
            {{ 'products.product.on_sale' | t }}
          </div>
        {%- endif -%}
      {%- endunless -%}

      {%- unless placeholder -%}
        {%- if show_quick_add and product.available -%}
          <div class="product-card__quick-add">
            <button
              type="button"
              class="product-card__quick-add-button"
              data-product-id="{{ product.id }}"
              data-variant-id="{{ product.selected_or_first_available_variant.id }}"
              aria-label="{{ 'products.product.quick_add' | t: product_title: product.title }}">
              <span class="product-card__quick-add-spinner"></span>
              <span class="product-card__quick-add-text">{{ 'products.product.quick_add' | t }}</span>
            </button>
          </div>
        {%- endif -%}
      {%- endunless -%}
    </div>

    <div class="product-card__info">
      {%- if show_vendor and product.vendor != blank -%}
        <div class="product-card__vendor">{{ product.vendor | escape }}</div>
      {%- endif -%}

      <h3 class="product-card__title">
        {%- if placeholder -%}
          {{ 'onboarding.product_title' | t }}
        {%- else -%}
          {{ product.title | escape }}
        {%- endif -%}
      </h3>

      <div class="product-card__price">
        {%- if placeholder -%}
          <span class="price">{{ 1999 | money }}</span>
        {%- else -%}
          {% render 'price'
            , product: product
            , use_variant: false %}
        {%- endif -%}
      </div>
    </div>
  </a>
</div>